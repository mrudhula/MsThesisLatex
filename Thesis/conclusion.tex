\chapter{Conclusions and Future Work}
\label{chapter_conclusion}

We present a real-time physics-based virtual fitting room framework. The simulation software simulates of a set of apparels on customized virtual avatars, including the effects of wind, inertia, gravity and collision on the apparel pieces. In addition, the framework includes a set of animation filters such as joint angle constraints, motion smoothing and foot-skate correction. The total framework consists of two distinct stages:

\begin{itemize}
  \item The design stage, where the avatar mesh and the apparel meshes are designed. 
  \item The simulation stage, where the apparel meshes are simulated on a virtual avatar which imitates the motions of the active user in real-time.   
\end{itemize}

The framework utilizes a set of external third party software packages including design suites and libraries. The Blender software~\cite{Blender} is used as the design suite, with a set of specific design principles for the use of meshes within the simulation system. The simulation software is built on top of the Open-Source 3D Rendering Engine~\cite{Knot2012}, which serves as the boilerplate including window management, peripheral input handling, low-level rendering and skeletal animation. The physics simulations including garment animation and collision detection are handled using the NVIDIA Physx Engine~\cite{WikiPhysx2012}. Kinect for Windows SDK~\cite{Microsoft2013} is used as the middleware for acquiring depth maps and user skeletal information. For computer-vision related functions, Open Computer Vision project (OpenCV)~\cite{opencv_library} is included. The IKAN library by Pennsylvenia University is used as the inverse kinematics solver~\cite{IKAN2013}. The motions filters, user measurements functions, modeling approaches and the bundling framework are in the scope of this thesis study. 

Modeling of the human meshes enables convenient creation and modification of the virtual avatars used in the simulation, including construction, skinning and painting. The avatar meshes also serve as the modeling mannequin of the apparel meshes, which must be aligned accordingly prior to being exported for simulation. Apparel meshes are first modeled as a whole, to be split into a dynamic part and a static part later. The vertices of the dynamic part are subsequently labeled as fixed or free, determining the effect of external forces during the simulation.

The motion filters in the software are a substantial part of the overall system, as the input quality from the depth sensors  is quite low compared to high-end motion capture systems. The correction in the upper limbs of the body employs angle constraints and bone splitting, in order to prevent the manifestation of unnatural orientations, especially in the lower part of the upper limbs. The lower limbs motion filter focus on the solution of foot skating problem, that is the sliding movement of the feet across the floor. Foot skate solution first constraints one of the feet to be stationary, followed by inverse kinematic solution to determine the orientations of the hip and knee joints. 

User measurement feature provides accurate dimensions of the current user, enabling the avatar to be customized accordingly in real-time. The process takes advantage of both the depth map and extracted skeletal joint coordinates to estimate the various dimensions in the human body. Using a set of different parameters (such as torso height and head height) to estimate the target parameter(body height) rather than a single measurement of the target parameter reduces the error. The final step is temporal averaging, for purpose of overcoming the possible temporal noises and errors.   

The simulation system is a complex software, because of many bundled libraries and the implemented custom features. There are a total of three different coordinate systems used in general, for rendering, physics simulation and inverse kinematics solution. The skeletal animation is achieved through a custom class which acts as the connector between the rendering engine and the depth sensor middleware. In addition to the motion filtering and user measurement features, a custom hand tracking feature is implemented, however not embedded within the system. 

\section{Future Work}

The modeling of the apparel meshes are currently done manually, with custom placement, separation and labeling, which makes the creation of new apparel models extremely expensive. On the other hand, all the steps in the process is automizable, hence a suite for rapid apparel mesh designing must be implemented before considering a commercial application for the framework.  

The most prominent problem within the overall framework is the inferior quality of the motion capture input. This problem manifests itself especially in lateral views of the user in larger distances. The solution of this problem requires fixes on both hardware and software sides. The resolution and quality of depth sensors are expected to increase in the future, resulting in better depth maps and skeletal joint information. Another important aspect on the hardware side is the introduction of multiple depth sensors configured to cooperate and construct a single depth map, in order to overcome the self-occlusion problem. More motion filters and optimizations will help the quality of the animation from the software side. Additional improvements include multi-threaded motion filtering, improving the quality of physics simulations and rendering, however such subjects are secondary in priority.  

